:root{
  /* VS Code Dark+ inspired */
  --vscode-bg:#1e1e1e;
  --vscode-panel:#252526;
  --vscode-sidebar:#252526;
  --vscode-editor:#1e1e1e;
  --vscode-gutter:#2b2b2b;
  --vscode-border:#3c3c3c;
  --vscode-accent:#007acc;
  --vscode-text:#d4d4d4;
  --vscode-muted:#9aa3b2;
  --danger:#e64b4b;
}

/* Keep NUI background transparent – DO NOT set body background */
html,body{ margin:0; height:100%; color:var(--vscode-text); font-family:Segoe UI, system-ui, -apple-system, Roboto, Helvetica, Arial, sans-serif; background: transparent !important; }
.hidden{ display:none; }

/* Title bar */
.vscode-titlebar{
  height:28px; display:flex; align-items:center; justify-content:space-between;
  padding:0 8px; background:var(--vscode-panel); border-bottom:1px solid var(--vscode-border);
  user-select:none;
}
.vscode-titlebar .traffic .dot{ display:inline-block; width:10px; height:10px; border-radius:50%; margin-right:6px; }
.vscode-titlebar .traffic .red{ background:#ff5f56; }
.vscode-titlebar .traffic .yellow{ background:#ffbd2e; }
.vscode-titlebar .traffic .green{ background:#27c93f; }
.vscode-titlebar .title{ opacity:.9; font-size:12px; }
.vscode-titlebar .title-actions .ghost{
  background:transparent; border:1px solid var(--vscode-border); color:var(--vscode-text);
  padding:4px 8px; border-radius:6px; cursor:pointer; font-size:12px;
}
.vscode-titlebar .title-actions .ghost:hover{ border-color:var(--vscode-accent); }

/* Tabs */
.vscode-tabs{ display:flex; gap:2px; background:var(--vscode-panel); border-bottom:1px solid var(--vscode-border); padding:4px; }
.tab{
  background:transparent; color:var(--vscode-text); border:1px solid transparent; padding:6px 10px; border-radius:6px; cursor:pointer; font-size:12px;
}
.tab.active{ background:#2d2d2d; border-color:var(--vscode-border); }

/* Workbench: sidebar + editor */
.workbench{ display:grid; grid-template-columns: 300px 1fr; height: calc(100vh - 28px - 34px - 24px); }
.explorer{
  background:var(--vscode-sidebar); border-right:1px solid var(--vscode-border); display:flex; flex-direction:column;
}
.explorer-title{ padding:8px 10px; font-size:12px; color:#c5c5c5; letter-spacing:.5px; }
.search{ margin:0 8px 8px; padding:8px; border-radius:6px; border:1px solid var(--vscode-border); background:#1a1a1a; color:var(--vscode-text); }
#list{ list-style:none; margin:0; padding:0; overflow:auto; }
#list li{ padding:6px 10px; border-top:1px solid rgba(0,0,0,0.05); border-bottom:1px solid rgba(255,255,255,0.03); cursor:pointer; font-size:13px; }
#list li:hover{ background:#2a2a2a; }
#list li.active{ background:#094771; }

.editor-group{ display:flex; flex-direction:column; background:var(--vscode-editor); }
/* === Fix toolbar overflow: keep actions visible, trim filename === */
.editor-toolbar{
  display: grid !important;
  grid-template-columns: minmax(0, 1fr) auto; /* يسار يتمدد ويقصر، يمين بعرضه الطبيعي */
  align-items: center;
  gap: 10px;
  border-bottom: 1px solid var(--vscode-border);
  background:#1b1b1b;
  position: relative;
  z-index: 1;
}

/* اسم الملف يتمدد لكن يتقصّر بنقاط وما يلف سطر */
.editor-toolbar .file-name{
  min-width: 0;              /* مهم جداً للـ ellipsis داخل grid/flex */
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: unset;               /* تجاهل أي flex قديم */
}

/* مجموعة الأزرار تبقى ثابتة على اليمين وبعرضها الطبيعي */
.editor-toolbar .toolbar-actions{
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 0 0 auto;            /* لا تنكمش */
}
.editor-toolbar .toolbar-actions > *{
  flex-shrink: 0;            /* ممنوع تنكمش لعناصرها */
}

/* تصغير بسيط عند الشاشات الضيقة بدل ما تختفي الأزرار */
@media (max-width: 1100px){
  .editor-toolbar .toolbar-actions button{ padding: 4px 8px; font-size: 12px; }
  #fmtSelect{ max-width: 120px; }
  .fmt-label{ display:none; } /* اخفي كلمة Format للحفاظ على المساحة */
}

/* اختياري: قصّر العنوان العلوي لو طويل */
.vscode-titlebar .title{
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}

.file-name{ font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; opacity:.9; }
.toolbar-actions button{
  background:#2a2a2a; color:var(--vscode-text); border:1px solid var(--vscode-border); padding:6px 10px; border-radius:6px; cursor:pointer; font-size:12px;
}
.toolbar-actions button:hover{ border-color:var(--vscode-accent); }
.toolbar-actions .danger{ border-color:#933; color:#f6cccc; }
.toolbar-actions .danger:hover{ background:#3a1212; border-color:var(--danger); color:#fff; }

/* Code editor */
.codewrap{
  position:relative; display:grid; grid-template-columns: 52px 1fr 6px; gap:0;
  height:100%;
}
.gutter{
  background:var(--vscode-gutter); border-right:1px solid var(--vscode-border); color:#858585;
  font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px; line-height:20px;
  padding:6px 8px; overflow:auto; white-space:nowrap;
}
#gutter div{ height:20px; }
#jsonInput{
  width:100%; height:100%; border:0; outline:0; resize:none; padding:6px 10px 6px 10px;
  background:var(--vscode-editor); color:var(--vscode-text);
  font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px; line-height:20px;
  caret-color:#ffffff;
}
.minimap{
  background:linear-gradient(to bottom, #3b3b3b, #2a2a2a); opacity:.65; border-left:1px solid var(--vscode-border);
}

/* Status bar */
.statusbar{
  height:24px; display:flex; align-items:center; justify-content:space-between; padding:0 10px;
  background:#007acc; color:#ffffff; font-size:12px; user-select:none;
}
.statusbar div{ opacity:.95; }

/* Toast */
.toast{ position:fixed; right:20px; bottom:36px; background:#0b111a; border:1px solid var(--vscode-border); padding:10px 12px; border-radius:10px; color:var(--vscode-text); box-shadow:0 10px 30px rgba(0,0,0,0.5); min-width: 200px;}
.toast.ok{ border-color: #0a5; }
.toast.err{ border-color: var(--danger); }

/* Format switch */
.fmt-label{ font-size:12px; opacity:.9; margin-right:6px; }
#fmtSelect{
  appearance:none; background:#2a2a2a; color:var(--vscode-text); border:1px solid var(--vscode-border);
  padding:6px 24px 6px 10px; border-radius:6px; cursor:pointer; font-size:12px; margin-right:8px;
}
#fmtSelect:hover{ border-color:var(--vscode-accent); }


/* ===== Modal (overlay + card) ===== */
.modal{
  position:fixed; inset:0;
  background: rgba(0,0,0,.45);
  backdrop-filter: blur(2px);
  display:flex; align-items:center; justify-content:center;
  z-index: 9999;
}
.modal.hidden{ display:none; }

.modal-card{
  width:min(720px, calc(100vw - 48px));
  max-height: calc(100vh - 96px);
  background: var(--vscode-panel);
  border:1px solid var(--vscode-border);
  border-radius:12px;
  box-shadow: 0 20px 60px rgba(0,0,0,.6);
  display:flex; flex-direction:column; overflow:hidden;
}

/* Header / Footer */
.modal-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 12px; border-bottom:1px solid var(--vscode-border); background:#1b1b1b;
}
.modal-title{ font-size:13px; opacity:.9; }
.icon-btn{
  background:transparent; border:0; color: var(--vscode-text);
  font-size:18px; line-height:1; padding:2px 6px; cursor:pointer;
}
.icon-btn:hover{ color: var(--vscode-accent); }

.modal-body{ padding:12px; overflow:auto; background: var(--vscode-editor); }
.modal-footer{
  display:flex; gap:8px; justify-content:flex-end;
  padding:10px 12px; border-top:1px solid var(--vscode-border); background:#1b1b1b;
}
.primary{
  background: var(--vscode-accent); color:#fff; border:0;
  padding:8px 14px; border-radius:6px; cursor:pointer;
}
.primary:hover{ filter: brightness(1.05); }
.ghost{
  background: transparent; border:1px solid var(--vscode-border); color: var(--vscode-text);
  padding:8px 12px; border-radius:6px; cursor:pointer;
}
.ghost:hover{ border-color: var(--vscode-accent); }

/* ===== Form layout ===== */
.fields{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }


.stack{ display:flex; flex-direction:column; gap:6px; }
.lbl{ font-size:12px; color: var(--vscode-muted); }

/* Inputs */
input[type="text"], input[type="number"], textarea, select{
  width:100%; padding:8px 10px; border-radius:6px;
  border:1px solid var(--vscode-border);
  background:#1a1a1a; color:var(--vscode-text);
  outline:none; transition: border-color .15s ease, box-shadow .15s ease;
}
input[type="text"]::placeholder, input[type="number"]::placeholder, textarea::placeholder{
  color:#8a8a8a;
}
input[type="text"]:focus, input[type="number"]:focus, textarea:focus, select:focus{
  border-color: var(--vscode-accent);
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--vscode-accent) 30%, transparent);
}
textarea{
  min-height: 120px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  line-height: 1.5;
  resize: vertical;
}

/* Pretty toggle for checkboxes */
input[type="checkbox"]{
  appearance:none; width:36px; height:20px; border-radius:999px;
  border:1px solid var(--vscode-border); background:#1a1a1a;
  position:relative; cursor:pointer; outline:none;
  transition: background .15s ease, border-color .15s ease;
}
input[type="checkbox"]::after{
  content:''; position:absolute; left:2px; top:2px;
  width:16px; height:16px; border-radius:50%; background:#bbb;
  transition:left .15s ease, background .15s ease;
}
input[type="checkbox"]:checked{
  background: var(--vscode-accent); border-color: var(--vscode-accent);
}
input[type="checkbox"]:checked::after{ left:18px; background:#fff; }


/* اجبر شبكة العمل على السماح بالانكماش بدون تمدد أفقي */
.workbench{
  grid-template-columns: 280px minmax(0, 1fr) !important; /* بدل 300px 1fr */
  min-width: 0;
}

/* اسم الملف + مساحة المحرر تقدر تنكمش بدون ما تولّد سكرول أفقي */
.editor-group,
.codewrap,
.vscode-tabs {
  min-width: 0 !important;
  max-width: 100% !important;
  overflow-x: hidden; /* لا سكرول أفقي */
}

/* ثبّت تخطيط شريط الأدوات كشبكة: يسار اسم الملف، يمين الأزرار */
.editor-toolbar{
  display: grid !important;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items: center;
  gap: 10px;
  max-width: 100%;
}

/* اسم الملف يقصّر بنقاط وما يزاحم الأزرار */
.editor-toolbar .file-name{
  min-width: 0 !important;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* مجموعة الأزرار تبقى على اليمين ولا تنكمش */
.editor-toolbar .toolbar-actions{
  justify-self: end;          /* الزرار لليمين */
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 0 0 auto;
}
.editor-toolbar .toolbar-actions > *{
  flex-shrink: 0;             /* ممنوع تنكمش */
}

/* لو الشاشة ضيقة اختصر الشريط بدل ما يطلع برا */
@media (max-width: 1100px){
  .fmt-label{ display:none; } /* اخفي كلمة Format */
  #fmtSelect{ max-width: 120px; }
  .editor-toolbar .toolbar-actions button{
    padding: 4px 8px;
    font-size: 12px;
  }
}

/* كإجراء وقائي: امنع أي تمدد أفقي للمشهد كله */
#app{
  width: 100vw;
  max-width: 100%;
  overflow-x: hidden;
}
